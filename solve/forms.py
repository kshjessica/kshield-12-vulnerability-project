from django import forms
from django.contrib.auth.forms import UserCreationForm
from django.contrib.auth.models import User


class CustomUserCreationForm(UserCreationForm):
    class Meta:
        model = User
        fields = ("username", "password1", "password2")

    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        self.fields["username"].help_text = (
            "필수. 150자 이하. 문자, 숫자 및 @/./+/-/_ 만 가능합니다."
        )
        self.fields[
            "password1"
        ].help_text = """
        <ul>
            <li>비밀번호는 최소 8자 이상이어야 합니다.</li>
            <li>비밀번호는 너무 흔하지 않아야 합니다.</li>
            <li>비밀번호는 숫자로만 구성될 수 없습니다.</li>
        </ul>
        """
        self.fields["password2"].help_text = (
            "확인을 위해 동일한 비밀번호를 다시 입력하십시오."
        )

    def clean_password2(self):
        password1 = self.cleaned_data.get("password1")
        password2 = self.cleaned_data.get("password2")
        if password1 and password2 and password1 != password2:
            raise forms.ValidationError("비밀번호가 일치하지 않습니다.")
        return password2
