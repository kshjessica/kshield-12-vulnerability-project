{% extends "base.html" %} {% block content %}
<div class="container mt-5">
  <h1 class="mb-4">String SQL injection 문제</h1>
  <p>
    코드에서 쿼리는 이전 예제에서 볼 수 있듯이 동적으로 생성됩니다. 쿼리는
    문자열을 연결하여 생성되므로 String SQL 인젝션에 취약합니다:
  </p>
  <pre class="p-3 border">
"SELECT * FROM user_data WHERE first_name = 'John' AND last_name = '" + lastName + "'"</pre
  >

  <p>
    아래 양식을 사용하여 사용자 테이블에서 모든 사용자를 검색해보세요. 완전한
    목록을 얻기 위해 특정 사용자 이름을 알 필요는 없습니다.
  </p>

  <hr />

  <form method="post" class="form-inline">
    {% csrf_token %}
    <label class="my-1 mr-2" for="first_name">SELECT * FROM</label>
    <input
      type="text"
      name="first_name"
      id="first_name"
      value="user_data WHERE first_name = 'John' AND last_name = '"
      class="form-control my-1 mr-sm-2"
      readonly
    />
    <input
      type="text"
      name="last_name"
      id="last_name"
      class="form-control my-1 mr-sm-2"
      placeholder="Smith"
    />
    <button type="submit" class="btn btn-primary my-1">계정 정보 변경</button>
  </form>

  <hr />

  {% if injection_successful %}
  <div class="alert alert-success mt-3">정답입니다! SQL Injection 성공!</div>
  <a href="{% url 'show_explanation' %}" class="btn btn-success mt-3"
    >설명 보러가기</a
  >
  <a href="{% url 'solve' %}" class="btn btn-secondary mt-3"
    >다른 문제 풀어보기</a
  >
  {% elif injection_unsuccessful %}
  <div class="alert alert-danger mt-3">
    SQL Injection 실패...다시 시도해보세요!
  </div>
  <button
    class="btn btn-link mt-3"
    onclick="document.getElementById('hint').style.display='block'"
  >
    힌트 보기
  </button>
  <div id="hint" class="alert alert-warning mt-3" style="display: none">
    {{ hint }}
  </div>
  {% endif %}
</div>
{% endblock %}
