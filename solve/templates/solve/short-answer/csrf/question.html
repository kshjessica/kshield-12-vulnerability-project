{% extends "base.html" %} {% block content %}
<div class="container mt-5">
  <h1 class="mb-4">CSRF 공격 방지</h1>
  <p>
    아래는 django view 파일의 코드 스니펫입니다. 주어진 코드의 취약점을 찾아내고
    이를 이용해 CSRF 공격을 방지하기 위해 지워야할 코드를 입력해보세요.
  </p>

  <pre class="p-3 border bg-light">
<code>
from django.shortcuts import render
from django.template import RequestContext

@csrf_exempt
def pay_to_point(request):
  user_id = request.POST.get('user_id', '')
  pay = request.POST.get('pay', '')
  product_info = request.POST.get('product_info', '')
  ret = handle_pay(user_id, pay, product_info)
  return render(request, '/view_wallet.html', {'wallet':ret}) 
</code>
  </pre>

  <form method="post" action="{% url 'short_answer_question' type %}">
    {% csrf_token %}
    <div class="form-group">
      <label for="answer"><strong>답</strong></label>
      <textarea
        name="answer"
        id="answer"
        rows="1"
        class="form-control"
        placeholder="취약점을 일으키는 코드 라인만 입력"
        style="font-family: monospace; font-size: 1em"
      ></textarea>
    </div>
    <button type="submit" class="btn btn-primary">제출</button>
  </form>

  <hr />

  {% if successful %}
  <div class="alert alert-success mt-3">정답입니다!</div>
  <a
    href="{% url 'short_answer_question_explanation' type %}"
    class="btn btn-success mt-3"
    >설명 보러가기</a
  >
  <a href="{% url 'solve' %}" class="btn btn-secondary mt-3"
    >다른 문제 풀어보기</a
  >
  {% elif unsuccessful %}
  <div class="alert alert-danger mt-3">틀렸습니다! 다시 시도해보세요.</div>
  <button
    class="btn btn-link mt-3"
    onclick="document.getElementById('hint').style.display='block'"
  >
    힌트 보기
  </button>
  <div id="hint" class="alert alert-warning mt-3" style="display: none">
    {{ hint }}
  </div>
  {% endif %}
</div>
{% endblock %}
