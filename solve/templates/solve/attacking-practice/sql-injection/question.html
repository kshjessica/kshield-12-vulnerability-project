{% extends "base.html" %} {% block content %}

<div class="container mt-5">
  <h1 class="mb-4">String SQL injection 문제</h1>
  <p>
    코드에서 쿼리는 아래 예제와 같은 형식으로 동적으로 생성됩니다. 쿼리는
    문자열을 연결하여 생성되므로 String SQL 인젝션에 취약합니다:
  </p>
  <pre class="p-3 border">
    cursor.execute("SELECT * FROM solve_sqlinj_1 WHERE username = '%s' AND password = '%s'" % (username, password))</pre
  >

  <p>
    아래 양식을 사용하여 사용자 테이블에서 관리자에 로그인 해 보세요.
  </p>

  <hr />

  <form method="post" class="form-inline">
    {% csrf_token %}
    <label class="my-1 mr-2" for="first_name">Username:</label>
    <input
      type="text"
      name="username"
      id="username"
      class="form-control my-1 mr-sm-2"
    />
    <br />
    <label class="my-1 mr-2" for="password">Password:</label>
    <input
      type="text"
      name="password"
      id="password"
      class="form-control my-1 mr-sm-2"
    />
    <button type="submit" class="btn btn-primary my-1">Login</button>
  </form>

  <hr />

  {% if injection_error == 0 %}
  <div class="alert alert-success mt-3">정답입니다! SQL Injection 성공!</div>
  <a
    href="{% url 'attacking_question_explanation' type %}"
    class="btn btn-success mt-3"
    >설명 보러가기</a
  >
  <a href="{% url 'solve' %}" class="btn btn-secondary mt-3"
    >다른 문제 풀어보기</a
  >
  {% elif injection_error == 1 %}
  <div class="alert alert-danger mt-3">
    SQL Injection 실패...다시 시도해보세요!
  </div>
  <button
    class="btn btn-link mt-3"
    onclick="document.getElementById('hint').style.display='block'"
  >
    힌트 보기
  </button>
  <div id="hint" class="alert alert-warning mt-3" style="display: none">
    {{ hint }}
  </div>
  {% endif %}
</div>
{% endblock %}
