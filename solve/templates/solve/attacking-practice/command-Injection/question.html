{% extends "base.html" %}
{% block content %}
<div class="container mt-5">
  <h1 class="mb-4">CommandInjection 문제</h1>
  <p>
    Command Injection은 공격자가 웹 애플리케이션의 취약점을 이용하여 
    시스템 명령을 실행할 수 있도록 하는 보안 취약점입니다. 
    이 취약점은 주로 웹 애플리케이션이 사용자 입력을 제대로 검증하지 않고 
    시스템 명령에 포함시킬 때 발생합니다.
  </p>
  
  {% if data %}
  <pre class="p-3 border">
    {{ data }}
  </pre>
  {% endif %}
  <p>
    다음은 ping 명령어를 구동하는 기능이 있는 페이지입니다. ls명령어를 함께 실행시켜보세요!!
  </p>
<hr />
  <form method="get" action="">
    <label>ping -n 3 <label><input type="text" name="host" id ="host" value = "8.8.8.8">
    <input type="submit" value="Submit">
  </form>
  <hr />

  {% if successful == 0 %}
  <div class="alert alert-success mt-3">정답입니다! cmdi 성공!</div>
  <a
    href="{% url 'attacking_question_explanation' type %}"
    class="btn btn-success mt-3"
    >설명 보러가기</a
  >
  <a href="{% url 'solve' %}" class="btn btn-secondary mt-3"
    >다른 문제 풀어보기</a
  >
  {% elif successful == 1 %}
  <div class="alert alert-danger mt-3">
    cmdi 실패...다시 시도해보세요!
  </div>
  <button
    class="btn btn-link mt-3"
    onclick="document.getElementById('hint').style.display='block'"
  >
    힌트 보기
  </button>
  <div id="hint" class="alert alert-warning mt-3" style="display: none">
    {{ hint }}
  </div>
  {% endif %}
</div>
{% endblock %}